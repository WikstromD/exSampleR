---
title: "Get started with exsampler"
name: exsampler-get-started
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Get started with exsampler}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse  = TRUE,
  comment   = "#>",
  fig.align = "center",
  out.width = "80%",   # ← key line: scale images to 80% of the text column
  fig.retina = 2       # crisp on HiDPI (optional)
)
```

# exsampler: Normal Simulation Guessing Game

## Overview

This page provides an overview of the **exsampler** package.

**exsampler** is a tool to assist visual inspection of (non)normality. It displays a 3×3 grids of either histograms, QQ plots, detrended QQ plots, or PP Plots where one randomly assigned plot contains the real data and the seven other plots contain data sampled from simulated normal distributions (Shapiro–Wilk *p*'s \> 0.05) with the same number of observations*,* mean, and standard deviation (and optionally, the same rounding). Plots from simulated data help calibrate the user's eyes for visually inspecting the distribution of their data. Selecting a plot reveals the location of the real data.

Users can choose to view plots from an example dataset with labeled distributions, or use with their own data already loaded in their global environment.

## Installation

First install Rtools from [CRAN](https://cran.r-project.org/bin/windows/Rtools/). Then run the following code:

```{r eval=FALSE, echo=TRUE}
install.packages("pak")

pak::pak("WikstromD/exsampler")
```

## Shiny app

```{r eval=FALSE, echo=TRUE}
exsampler::run_app()
```

## What you’ll see

When you choose a variable and generate plots, the app displays a **3×3** **grid of panels**. One panel contains the real data; the rest are simulated datasets sampled from normal distributions with the same number of observations, mean, and standard deviation. Below is an illustrative example using the variable "Heavy_Right_Skew" from the example dataset included with `exsampler`.

-   **Histogram** – binned frequencies with density and normal curves using `ggplot2.`

```{r echo=FALSE, message=FALSE, warning=FALSE}
suppressPackageStartupMessages({
  library(exsampler)
  library(ggplot2)
  library(patchwork)
})

# Fallback if not exported in this session (pkgdown/load_all can bite)
if (!exists("scale_to_1_10", mode = "function")) {
  scale_to_1_10 <- getFromNamespace("scale_to_1_10", "exsampler")
}


ex <- exsampler::generate_exsample_distributions(n = 200, seed = 123)
df <- data.frame(example_var = ex[["Heavy_Right_Skew"]])


info <- exsampler:::generate_random_data_for_plot_grid(
  data            = df,
  variable_name   = "example_var",
  seed_modifier   = 1L,
  match_increment = FALSE
)

plots <- lapply(
  info$shuffled_data_frames,
  function(d) exsampler:::create_single_plot(
    df        = d,
    var       = info$variable_name,
    plot_type = "histogram",
    bands     = NULL
  )
)

patchwork::wrap_plots(plots, ncol = info$grid_cols)

```

-   **QQ plot** – compares sample quantiles to a normal reference line using `qqplotr`.

```{r echo=FALSE, message=FALSE, warning=FALSE}
suppressPackageStartupMessages({
  library(exsampler)
  library(ggplot2)
  library(patchwork)
})

ex <- exsampler::generate_exsample_distributions(n = 200, seed = 123)
df <- data.frame(example_var = ex[["Heavy_Right_Skew"]])

info <- exsampler:::generate_random_data_for_plot_grid(
  data            = df,
  variable_name   = "example_var",
  seed_modifier   = 2L,
  match_increment = FALSE
)

plots <- lapply(
  info$shuffled_data_frames,
  function(d) exsampler:::create_single_plot(
    df        = d,
    var       = info$variable_name,
    plot_type = "qq_normal",
    bands     = NULL
  )
)

patchwork::wrap_plots(plots, ncol = info$grid_cols)

```

-   **Detrended QQ plot** – compare quantiles' deviation from what's expected from a normal distribution using `qqplotr`.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
suppressPackageStartupMessages({
  library(exsampler)
  library(ggplot2)
  library(patchwork)
})

ex <- exsampler::generate_exsample_distributions(n = 200, seed = 123)
df <- data.frame(example_var = ex[["Heavy_Right_Skew"]])

info <- exsampler:::generate_random_data_for_plot_grid(
  data            = df,
  variable_name   = "example_var",
  seed_modifier   = 3L,
  match_increment = FALSE
)

plots <- lapply(
  info$shuffled_data_frames,
  function(d) exsampler:::create_single_plot(
    df        = d,
    var       = info$variable_name,
    plot_type = "qq_detrended",
    bands     = NULL
  )
)

patchwork::wrap_plots(plots, ncol = info$grid_cols)

```

-   **PP plot** – plots the proportion of observations at or below each value against the proportion predicted by a normal model using `qqplotr`.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
suppressPackageStartupMessages({
  library(exsampler)
  library(ggplot2)
  library(patchwork)
})

ex <- exsampler::generate_exsample_distributions(n = 200, seed = 123)
df <- data.frame(example_var = ex[["Heavy_Right_Skew"]])

info <- exsampler:::generate_random_data_for_plot_grid(
  data            = df,
  variable_name   = "example_var",
  seed_modifier   = 4L,
  match_increment = FALSE
)

plots <- lapply(
  info$shuffled_data_frames,
  function(d) exsampler:::create_single_plot(
    df        = d,
    var       = info$variable_name,
    plot_type = "pp_plot",
    bands     = NULL
  )
)

patchwork::wrap_plots(plots, ncol = info$grid_cols)

```

Click **Generate Plots** to create a fresh grid of simulations. The sidebar lets you choose the variable, plot type, and whether to match simulated data **granularity** (useful for integer scales).
